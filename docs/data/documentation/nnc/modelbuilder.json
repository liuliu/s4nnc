{"sections":[],"abstract":[{"type":"text","text":"A model builder is a more generic type of model. A model can be quite static,"},{"type":"text","text":" "},{"type":"text","text":"thus, you have to be quite careful to have a model work with dynamic inputs."},{"text":" ","type":"text"},{"text":"You cannot use reshape, or anything that can generate fixed tensor outputs from","type":"text"},{"text":" ","type":"text"},{"text":"a fixed inputs.","type":"text"}],"primaryContentSections":[{"kind":"declarations","declarations":[{"platforms":["Linux"],"languages":["swift"],"tokens":[{"text":"final","kind":"keyword"},{"text":" ","kind":"text"},{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"ModelBuilder","kind":"identifier"},{"text":"<","kind":"text"},{"text":"T","kind":"genericParameter"},{"text":">","kind":"text"}]}]},{"content":[{"text":"Overview","type":"heading","anchor":"overview","level":2},{"inlineContent":[{"text":"A model builder on the other hand doesn’t have that restriction. When input changes,","type":"text"},{"text":" ","type":"text"},{"text":"it simply calls the given builder closure to construct a new model. In such way,","type":"text"},{"text":" ","type":"text"},{"text":"you can continue to use reshape etc to assume fixed inputs and outputs, it will just","type":"text"},{"text":" ","type":"text"},{"text":"work for dynamic inputs. The newly built model will carry over stateful components","type":"text"},{"text":" ","type":"text"},{"text":"(parameters) from the old models, thus, it doesn’t reset your training. This also means","type":"text"},{"text":" ","type":"text"},{"text":"you need to make sure parameter shape won’t change when input changes, otherwise we","type":"text"},{"text":" ","type":"text"},{"text":"will fatal.","type":"text"}],"type":"paragraph"}],"kind":"content"}],"relationshipsSections":[{"title":"Inherits From","type":"inheritsFrom","kind":"relationships","identifiers":["doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/AnyModelBuilder"]},{"title":"Conforms To","type":"conformsTo","kind":"relationships","identifiers":["doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/AnyModel"]}],"variants":[{"paths":["\/documentation\/nnc\/modelbuilder"],"traits":[{"interfaceLanguage":"swift"}]}],"topicSections":[{"title":"Initializers","identifiers":["doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/init(_:name:)-4pup0","doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/init(_:name:)-55gex"]},{"title":"Instance Methods","identifiers":["doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/callAsFunction(_:inputs:_:streamContext:)-101bg","doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/callAsFunction(_:inputs:_:streamContext:)-4i10p","doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/callAsFunction(inputs:_:streamContext:)-4tnis","doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/callAsFunction(inputs:_:streamContext:)-8pae9","doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/compile(_:inputs:isEager:)-1lsvw","doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/compile(_:inputs:isEager:)-8ge5z","doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/compile(inputs:isEager:)-4kat6","doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/compile(inputs:isEager:)-4yweq"]}],"hierarchy":{"paths":[["doc:\/\/org.liuliu.s4nnc\/documentation\/NNC"]]},"kind":"symbol","metadata":{"navigatorTitle":[{"kind":"identifier","text":"ModelBuilder"}],"role":"symbol","symbolKind":"class","title":"ModelBuilder","roleHeading":"Class","fragments":[{"text":"class","kind":"keyword"},{"kind":"text","text":" "},{"kind":"identifier","text":"ModelBuilder"}],"externalID":"s:3NNC12ModelBuilderC","modules":[{"name":"NNC"}]},"schemaVersion":{"patch":0,"minor":3,"major":0},"identifier":{"url":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder","interfaceLanguage":"swift"},"references":{"doc://org.liuliu.s4nnc/documentation/NNC":{"type":"topic","kind":"symbol","role":"collection","abstract":[],"identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC","title":"NNC","url":"\/documentation\/nnc"},"doc://org.liuliu.s4nnc/documentation/NNC/ModelBuilder/init(_:name:)-55gex":{"type":"topic","kind":"symbol","role":"symbol","abstract":[],"conformance":{"constraints":[{"code":"T","type":"codeVoice"},{"text":" is ","type":"text"},{"type":"codeVoice","code":"()"},{"text":".","type":"text"}],"availabilityPrefix":[{"type":"text","text":"Available when"}],"conformancePrefix":[{"type":"text","text":"Conforms when"}]},"title":"init(_:name:)","fragments":[{"kind":"keyword","text":"convenience"},{"kind":"text","text":" "},{"kind":"identifier","text":"init"},{"kind":"text","text":"(([any "},{"preciseIdentifier":"s:3NNC16DynamicGraph_AnyP","kind":"typeIdentifier","text":"DynamicGraph_Any"},{"kind":"text","text":"]) -> "},{"kind":"typeIdentifier","text":"Model","preciseIdentifier":"s:3NNC5ModelC"},{"kind":"text","text":", "},{"kind":"externalParam","text":"name"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":")"}],"url":"\/documentation\/nnc\/modelbuilder\/init(_:name:)-55gex","identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/init(_:name:)-55gex"},"doc://org.liuliu.s4nnc/documentation/NNC/ModelBuilder/compile(_:inputs:isEager:)-8ge5z":{"type":"topic","title":"compile(_:inputs:isEager:)","url":"\/documentation\/nnc\/modelbuilder\/compile(_:inputs:iseager:)-8ge5z","kind":"symbol","abstract":[{"type":"text","text":"Compile a model with the given inputs without executing it. After this, you can load"},{"type":"text","text":" "},{"type":"text","text":"parameters from the store."}],"fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"compile"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"T"},{"kind":"text","text":", "},{"kind":"externalParam","text":"inputs"},{"kind":"text","text":": any "},{"kind":"typeIdentifier","text":"DynamicGraph_Any","preciseIdentifier":"s:3NNC16DynamicGraph_AnyP"},{"text":"..., ","kind":"text"},{"text":"isEager","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"Bool","preciseIdentifier":"s:Sb","kind":"typeIdentifier"},{"kind":"text","text":")"}],"identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/compile(_:inputs:isEager:)-8ge5z","role":"symbol"},"doc://org.liuliu.s4nnc/documentation/NNC/ModelBuilder/compile(_:inputs:isEager:)-1lsvw":{"abstract":[{"type":"text","text":"Compile a model with the given inputs without executing it. After this, you can load"},{"type":"text","text":" "},{"type":"text","text":"parameters from the store."}],"type":"topic","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"compile"},{"kind":"text","text":"("},{"kind":"typeIdentifier","text":"T"},{"kind":"text","text":", "},{"kind":"externalParam","text":"inputs"},{"kind":"text","text":": [any "},{"kind":"typeIdentifier","text":"DynamicGraph_Any","preciseIdentifier":"s:3NNC16DynamicGraph_AnyP"},{"kind":"text","text":"], "},{"kind":"externalParam","text":"isEager"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:Sb","text":"Bool"},{"kind":"text","text":")"}],"url":"\/documentation\/nnc\/modelbuilder\/compile(_:inputs:iseager:)-1lsvw","title":"compile(_:inputs:isEager:)","kind":"symbol","role":"symbol","identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/compile(_:inputs:isEager:)-1lsvw"},"doc://org.liuliu.s4nnc/documentation/NNC/ModelBuilder/init(_:name:)-4pup0":{"type":"topic","kind":"symbol","role":"symbol","abstract":[],"title":"init(_:name:)","fragments":[{"text":"init","kind":"identifier"},{"text":"((","kind":"text"},{"text":"T","kind":"typeIdentifier"},{"text":", [any ","kind":"text"},{"text":"DynamicGraph_Any","preciseIdentifier":"s:3NNC16DynamicGraph_AnyP","kind":"typeIdentifier"},{"kind":"text","text":"]) -> "},{"kind":"typeIdentifier","text":"Model","preciseIdentifier":"s:3NNC5ModelC"},{"kind":"text","text":", "},{"kind":"externalParam","text":"name"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"String","preciseIdentifier":"s:SS"},{"kind":"text","text":")"}],"url":"\/documentation\/nnc\/modelbuilder\/init(_:name:)-4pup0","identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/init(_:name:)-4pup0"},"doc://org.liuliu.s4nnc/documentation/NNC/ModelBuilder/callAsFunction(_:inputs:_:streamContext:)-101bg":{"type":"topic","title":"callAsFunction(_:inputs:_:streamContext:)","url":"\/documentation\/nnc\/modelbuilder\/callasfunction(_:inputs:_:streamcontext:)-101bg","kind":"symbol","abstract":[],"fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"callAsFunction"},{"kind":"text","text":"<"},{"kind":"genericParameter","text":"U"},{"kind":"text","text":">("},{"kind":"typeIdentifier","text":"T"},{"kind":"text","text":", "},{"kind":"externalParam","text":"inputs"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"U"},{"kind":"text","text":", any "},{"kind":"typeIdentifier","text":"DynamicGraph_Any","preciseIdentifier":"s:3NNC16DynamicGraph_AnyP"},{"kind":"text","text":"..., "},{"kind":"externalParam","text":"streamContext"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:3NNC13StreamContextC","text":"StreamContext"},{"kind":"text","text":"?) -> ["},{"kind":"typeIdentifier","text":"U"},{"text":".","kind":"text"},{"text":"AnyTensor","preciseIdentifier":"s:3NNC27DynamicGraph_AnyTensorGroupP0dE0Qa","kind":"typeIdentifier"},{"text":"]","kind":"text"}],"identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/callAsFunction(_:inputs:_:streamContext:)-101bg","role":"symbol"},"doc://org.liuliu.s4nnc/documentation/NNC/ModelBuilder/compile(inputs:isEager:)-4kat6":{"abstract":[{"type":"text","text":"Compile a model with the given inputs without executing it. After this, you can load"},{"type":"text","text":" "},{"type":"text","text":"parameters from the store."}],"type":"topic","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"compile"},{"kind":"text","text":"("},{"kind":"externalParam","text":"inputs"},{"kind":"text","text":": any "},{"kind":"typeIdentifier","text":"DynamicGraph_Any","preciseIdentifier":"s:3NNC16DynamicGraph_AnyP"},{"kind":"text","text":"..., "},{"text":"isEager","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"Bool","preciseIdentifier":"s:Sb","kind":"typeIdentifier"},{"text":")","kind":"text"}],"url":"\/documentation\/nnc\/modelbuilder\/compile(inputs:iseager:)-4kat6","title":"compile(inputs:isEager:)","kind":"symbol","role":"symbol","identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/compile(inputs:isEager:)-4kat6","conformance":{"availabilityPrefix":[{"text":"Available when","type":"text"}],"conformancePrefix":[{"text":"Conforms when","type":"text"}],"constraints":[{"type":"codeVoice","code":"T"},{"text":" is ","type":"text"},{"type":"codeVoice","code":"()"},{"text":".","type":"text"}]}},"doc://org.liuliu.s4nnc/documentation/NNC/ModelBuilder/callAsFunction(inputs:_:streamContext:)-4tnis":{"type":"topic","kind":"symbol","role":"symbol","abstract":[],"conformance":{"constraints":[{"type":"codeVoice","code":"T"},{"type":"text","text":" is "},{"type":"codeVoice","code":"()"},{"type":"text","text":"."}],"availabilityPrefix":[{"type":"text","text":"Available when"}],"conformancePrefix":[{"type":"text","text":"Conforms when"}]},"title":"callAsFunction(inputs:_:streamContext:)","fragments":[{"kind":"keyword","text":"func"},{"kind":"text","text":" "},{"kind":"identifier","text":"callAsFunction"},{"kind":"text","text":"<"},{"kind":"genericParameter","text":"U"},{"kind":"text","text":">("},{"kind":"externalParam","text":"inputs"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"U"},{"kind":"text","text":", any "},{"kind":"typeIdentifier","preciseIdentifier":"s:3NNC16DynamicGraph_AnyP","text":"DynamicGraph_Any"},{"kind":"text","text":"..., "},{"kind":"externalParam","text":"streamContext"},{"kind":"text","text":": "},{"text":"StreamContext","preciseIdentifier":"s:3NNC13StreamContextC","kind":"typeIdentifier"},{"text":"?) -> [","kind":"text"},{"text":"U","kind":"typeIdentifier"},{"text":".","kind":"text"},{"text":"AnyTensor","preciseIdentifier":"s:3NNC27DynamicGraph_AnyTensorGroupP0dE0Qa","kind":"typeIdentifier"},{"text":"]","kind":"text"}],"url":"\/documentation\/nnc\/modelbuilder\/callasfunction(inputs:_:streamcontext:)-4tnis","identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/callAsFunction(inputs:_:streamContext:)-4tnis"},"doc://org.liuliu.s4nnc/documentation/NNC/ModelBuilder":{"navigatorTitle":[{"kind":"identifier","text":"ModelBuilder"}],"type":"topic","kind":"symbol","role":"symbol","abstract":[{"text":"A model builder is a more generic type of model. A model can be quite static,","type":"text"},{"type":"text","text":" "},{"type":"text","text":"thus, you have to be quite careful to have a model work with dynamic inputs."},{"type":"text","text":" "},{"type":"text","text":"You cannot use reshape, or anything that can generate fixed tensor outputs from"},{"type":"text","text":" "},{"type":"text","text":"a fixed inputs."}],"title":"ModelBuilder","fragments":[{"kind":"keyword","text":"class"},{"kind":"text","text":" "},{"kind":"identifier","text":"ModelBuilder"}],"url":"\/documentation\/nnc\/modelbuilder","identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder"},"doc://org.liuliu.s4nnc/documentation/NNC/ModelBuilder/callAsFunction(_:inputs:_:streamContext:)-4i10p":{"type":"topic","kind":"symbol","role":"symbol","abstract":[],"title":"callAsFunction(_:inputs:_:streamContext:)","fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"callAsFunction","kind":"identifier"},{"text":"<","kind":"text"},{"text":"U","kind":"genericParameter"},{"text":">(","kind":"text"},{"kind":"typeIdentifier","text":"T"},{"kind":"text","text":", "},{"kind":"externalParam","text":"inputs"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"U"},{"kind":"text","text":", [any "},{"kind":"typeIdentifier","text":"DynamicGraph_Any","preciseIdentifier":"s:3NNC16DynamicGraph_AnyP"},{"text":"], ","kind":"text"},{"text":"streamContext","kind":"externalParam"},{"text":": ","kind":"text"},{"text":"StreamContext","preciseIdentifier":"s:3NNC13StreamContextC","kind":"typeIdentifier"},{"kind":"text","text":"?) -> ["},{"kind":"typeIdentifier","text":"U"},{"kind":"text","text":"."},{"kind":"typeIdentifier","preciseIdentifier":"s:3NNC27DynamicGraph_AnyTensorGroupP0dE0Qa","text":"AnyTensor"},{"kind":"text","text":"]"}],"url":"\/documentation\/nnc\/modelbuilder\/callasfunction(_:inputs:_:streamcontext:)-4i10p","identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/callAsFunction(_:inputs:_:streamContext:)-4i10p"},"doc://org.liuliu.s4nnc/documentation/NNC/ModelBuilder/compile(inputs:isEager:)-4yweq":{"fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"kind":"identifier","text":"compile"},{"kind":"text","text":"("},{"kind":"externalParam","text":"inputs"},{"kind":"text","text":": [any "},{"kind":"typeIdentifier","text":"DynamicGraph_Any","preciseIdentifier":"s:3NNC16DynamicGraph_AnyP"},{"kind":"text","text":"], "},{"kind":"externalParam","text":"isEager"},{"kind":"text","text":": "},{"kind":"typeIdentifier","preciseIdentifier":"s:Sb","text":"Bool"},{"kind":"text","text":")"}],"role":"symbol","abstract":[{"text":"Compile a model with the given inputs without executing it. After this, you can load","type":"text"},{"text":" ","type":"text"},{"text":"parameters from the store.","type":"text"}],"url":"\/documentation\/nnc\/modelbuilder\/compile(inputs:iseager:)-4yweq","type":"topic","identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/compile(inputs:isEager:)-4yweq","kind":"symbol","conformance":{"availabilityPrefix":[{"type":"text","text":"Available when"}],"conformancePrefix":[{"type":"text","text":"Conforms when"}],"constraints":[{"code":"T","type":"codeVoice"},{"type":"text","text":" is "},{"code":"()","type":"codeVoice"},{"type":"text","text":"."}]},"title":"compile(inputs:isEager:)"},"doc://org.liuliu.s4nnc/documentation/NNC/AnyModelBuilder":{"abstract":[{"text":"A type-erased model builder.","type":"text"}],"fragments":[{"text":"class","kind":"keyword"},{"text":" ","kind":"text"},{"text":"AnyModelBuilder","kind":"identifier"}],"identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/AnyModelBuilder","title":"AnyModelBuilder","role":"symbol","url":"\/documentation\/nnc\/anymodelbuilder","type":"topic","kind":"symbol","navigatorTitle":[{"text":"AnyModelBuilder","kind":"identifier"}]},"doc://org.liuliu.s4nnc/documentation/NNC/ModelBuilder/callAsFunction(inputs:_:streamContext:)-8pae9":{"abstract":[],"fragments":[{"text":"func","kind":"keyword"},{"text":" ","kind":"text"},{"text":"callAsFunction","kind":"identifier"},{"text":"<","kind":"text"},{"text":"U","kind":"genericParameter"},{"text":">(","kind":"text"},{"text":"inputs","kind":"externalParam"},{"text":": ","kind":"text"},{"kind":"typeIdentifier","text":"U"},{"kind":"text","text":", [any "},{"kind":"typeIdentifier","text":"DynamicGraph_Any","preciseIdentifier":"s:3NNC16DynamicGraph_AnyP"},{"kind":"text","text":"], "},{"kind":"externalParam","text":"streamContext"},{"kind":"text","text":": "},{"kind":"typeIdentifier","text":"StreamContext","preciseIdentifier":"s:3NNC13StreamContextC"},{"kind":"text","text":"?) -> ["},{"kind":"typeIdentifier","text":"U"},{"kind":"text","text":"."},{"kind":"typeIdentifier","preciseIdentifier":"s:3NNC27DynamicGraph_AnyTensorGroupP0dE0Qa","text":"AnyTensor"},{"text":"]","kind":"text"}],"identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/ModelBuilder\/callAsFunction(inputs:_:streamContext:)-8pae9","title":"callAsFunction(inputs:_:streamContext:)","conformance":{"constraints":[{"code":"T","type":"codeVoice"},{"type":"text","text":" is "},{"code":"()","type":"codeVoice"},{"type":"text","text":"."}],"availabilityPrefix":[{"type":"text","text":"Available when"}],"conformancePrefix":[{"type":"text","text":"Conforms when"}]},"role":"symbol","url":"\/documentation\/nnc\/modelbuilder\/callasfunction(inputs:_:streamcontext:)-8pae9","type":"topic","kind":"symbol"},"doc://org.liuliu.s4nnc/documentation/NNC/AnyModel":{"url":"\/documentation\/nnc\/anymodel","title":"AnyModel","identifier":"doc:\/\/org.liuliu.s4nnc\/documentation\/NNC\/AnyModel","role":"symbol","navigatorTitle":[{"text":"AnyModel","kind":"identifier"}],"abstract":[],"kind":"symbol","fragments":[{"text":"protocol","kind":"keyword"},{"text":" ","kind":"text"},{"text":"AnyModel","kind":"identifier"}],"type":"topic"}}}